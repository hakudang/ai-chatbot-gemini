# 顧客要求書（Client Requirements）

AIチャットボット（Gemini）

```
Version: 1.1
Owner: BrSE Dang
Status: Draft → To be Frozen
```

## 1. 目的（Purpose）
本要件書は、Webサイトに組み込み可能なAIチャットボットを構築するための顧客要求を定義するものである。
本チャットボットは Google Gemini を利用し、利用者の質問に対して迅速かつ柔軟に回答することを目的とする。

目的は以下の通りである。
- Webサイト上のユーザーエンゲージメント向上
- 即時的な情報提供・サポートの実現
- PCおよびモバイル端末双方での快適な利用体験の提供

---

## 2. 背景およびステークホルダー

### 2.1 背景
本チャットボットは、Webページ右下に表示されるポップアップ型ウィジェットとして提供される。
トグルボタンにより開閉可能であり、ヘッダー、会話エリア、入力フォームから構成される。

### 2.2 ステークホルダー
- **End User**：チャットボットを利用して質問・相談を行うWebサイト利用者
- **Client / Product Owner**：チャットボットの目的・内容を決定する責任者
- **BrSE / PM**：要件定義、スコープ管理、合意形成を担当
- **Dev / QA**：実装、テスト、リリースを担当

---

## 3. スコープ（Scope）

### 3.1 In Scope（v1）
1. **基本チャット機能**
   - ユーザーが質問を入力し、AIが回答を返す
   - ユーザー／ボットのメッセージをバブル形式で表示

2. **ポップアップ型ウィジェットUI**
   - 右下に表示されるトグルボタン
   - Header / Body / Footer で構成されるチャット画面

3. **Emoji Picker**
   - 絵文字を選択し、入力欄のカーソル位置に挿入可能

4. **画像アップロード（Vision対応）**
   - 画像選択、プレビュー表示、キャンセル機能
   - 画像を含めてAIへ問い合わせ可能

5. **Thinking Indicator**
   - AI応答待機中に「思考中（3点ドット）」を表示

6. **レスポンシブ対応**
   - モバイルでは全画面表示、ヘッダー／フッター固定

7. **基本的なエラーハンドリング**
   - APIエラー、ネットワークエラー、Quota超過、Key不正時の表示

### 3.2 Out of Scope（v1）
- ユーザー認証・権限管理
- サーバー保存による履歴共有（マルチデバイス同期）
- ストリーミング表示（トークン逐次表示）
- 管理画面、分析機能、モデレーション強化
- 複数AIモデル／プロバイダ対応

---

## 4. 機能要件（Functional Requirements）

| ID | 機能概要 | 詳細 |
|----|----------|------|
| FR-01 | チャットボット開閉 | トグルボタンによる表示／非表示 |
| FR-02 | 初期メッセージ | 初回起動時にボットの挨拶表示 |
| FR-03 | テキスト送信 | テキスト入力・送信・回答表示 |
| FR-04 | Enter操作 | Enter送信、Shift+Enter改行 |
| FR-05 | 入力欄自動拡張 | 内容に応じた高さ調整 |
| FR-06 | 画像アップロード | 画像選択・プレビュー・取消 |
| FR-07 | Vision対応 | 画像＋テキストでAI問い合わせ |
| FR-08 | Emoji Picker | 絵文字挿入 |
| FR-09 | Thinking表示 | 応答待機中の表示 |
| FR-10 | エラー表示 | ユーザー向けエラー通知 |

---

## 5. 非機能要件（Non-Functional Requirements）

### NFR-01 セキュリティ
- 本番環境ではフロントエンドにAPIキーを直接埋め込まない
- サーバープロキシ利用を推奨

### NFR-02 パフォーマンス
- 短文応答は目標5秒以内
- スクロール・UI操作が滑らかであること

### NFR-03 ブラウザ互換性
- Desktop：Chrome / Edge 最新版
- Mobile：iOS Safari / Android Chrome 最新版

### NFR-04 画像制限
- 画像サイズは5MB以下を推奨

### NFR-05 拡張性
- UI層とAI呼び出し層を分離した設計

---

## 6. データおよびAPI概要

### 6.1 Input
- ユーザーのテキスト入力
- 添付画像（base64 + mimeType）

### 6.2 Output
- AIによるテキスト回答

### 6.3 保存
- v1ではメモリ上で保持
- v1.1以降で localStorage による保持を検討

---

## 7. 前提条件および制約

### Assumptions
- クライアントがGemini APIキーを提供
- WebサイトにJS/CSS組み込みが可能

### Constraints
- プロキシ未使用の場合、APIキー露出リスクあり
- 無料枠Quotaに制限がある可能性

---

## 8. 受入基準（Acceptance Criteria）
1. チャットボットの開閉が正常に動作する
2. テキスト送信に対してAIが回答する
3. 画像付き質問に適切な回答が返る
4. Emoji挿入が正しく機能する
5. Thinking表示が残留しない
6. エラー発生時もUIが継続利用可能
7. モバイル表示で操作不能にならない

---

## 9. Open Points（解決済み）

- OP-01：用途 → 汎用アシスタント
- OP-02：言語 → 英語デフォルト、自動判定
- OP-03：履歴保存 → localStorage
- OP-04：画像制限 → 5MB、PNG/JPG/WebP
- OP-05：Proxy構成 → Phase2対応

---

## 10. 次ステップ
- System Requirements 作成
- Business Rules / Use Case 整備

---

## 11. 改訂履歴

| Version | Date | Description | Author |
|--------|------|-------------|--------|
| 1.0 | 2026-01-29 | Initial Draft | BrSE Dang |
| 1.1 | 2026-01-29 | Open Points反映 | BrSE Dang |
